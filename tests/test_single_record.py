#!/usr/bin/env python3

import pandas as pd
import json

# Читаем первые 5 записей из листа "Чаты"
excel_file = 'data/Минобр 2025-12-14.xlsx'
df = pd.read_excel(excel_file, sheet_name='Чаты', nrows=5)

print("Первые 5 записей из листа 'Чаты':")
print("=" * 50)

for i, row in df.iterrows():
    print(f"\nЗапись {i+1}:")
    print(f"  Регион: {row['Регион']}")
    print(f"  ID чата: {row['ID чата']}")
    print(f"  Название чата: {row['Название чата']}")
    print(f"  Ссылка на чат: {row['Ссылка на чат']}")
    print(f"  Телефон владельца: {row['Телефон владельца чата']}")
    print(f"  Организация: {row['Организация']}")
    print(f"  ИНН: {row['ИНН']}")
    print(f"  КПП: {row['КПП']}")
    print(f"  Факультет: {row['Факультет']}")
    print(f"  Курс: {row['Курс']}")
    print(f"  Группа: {row['Группа']}")
    print(f"  Добавлен пользователь: {row['Добавлени пользователь']}")
    print(f"  Добавлен администратор: {row['Добавлен администратор']}")
    
    # Проверяем обязательные поля
    if pd.isna(row['ИНН']) or pd.isna(row['Ссылка на чат']):
        print(f"  ⚠️  ПРОБЛЕМА: Отсутствуют обязательные поля (ИНН или ссылка на чат)")
    else:
        print(f"  ✅ Обязательные поля присутствуют")