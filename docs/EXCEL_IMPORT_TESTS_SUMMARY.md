# ‚úÖ –¢–µ—Å—Ç—ã Excel –∏–º–ø–æ—Ä—Ç–∞ - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

## üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤

**–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 17  
**–ü—Ä–æ–π–¥–µ–Ω–æ:** 17 ‚úÖ  
**–ü—Ä–æ–≤–∞–ª–µ–Ω–æ:** 0 ‚ùå  

## üß™ –¢–µ—Å—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ Excel

### TestExcelFileParsing_18Columns ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å 18 –∫–æ–ª–æ–Ω–∫–∞–º–∏.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.01s)

### TestExcelFileParsing_MultipleRows ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)

### TestExcelFileParsing_InsufficientColumns ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ–∞–π–ª–æ–≤ —Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–æ–ª–æ–Ω–æ–∫.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)

### TestExcelFileParsing_EmptyFile ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—É—Å—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)

### TestExcelFileParsing_LargeFile ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (1000 —Å—Ç—Ä–æ–∫).

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.12s)  
**–õ–æ–≥:** Successfully parsed large file with 1001 rows

### TestExcelFileParsing_CyrillicText ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–∏—Ä–∏–ª–ª–∏—Ü—ã.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)

## üìû –¢–µ—Å—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

### TestNormalizePhone_VariousFormats ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö:

- ‚úÖ 11 digits starting with 7: `79884753064` ‚Üí `+79884753064`
- ‚úÖ 11 digits starting with 8: `89884753064` ‚Üí `+79884753064`
- ‚úÖ 10 digits: `9884753064` ‚Üí `+79884753064`
- ‚úÖ With spaces: `7 988 475 30 64` ‚Üí `+79884753064`
- ‚úÖ With dashes: `7-988-475-30-64` ‚Üí `+79884753064`
- ‚úÖ With parentheses: `7(988)475-30-64` ‚Üí `+79884753064`
- ‚úÖ With plus already: `+79884753064` ‚Üí `+79884753064`
- ‚úÖ Empty string: `` ‚Üí ``
- ‚úÖ Only letters: `abc` ‚Üí ``
- ‚úÖ Mixed: `7abc988def4753064` ‚Üí `+79884753064`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)

## üì§ –¢–µ—Å—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

### TestUploadExcelFile_ValidFile ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –≤–∞–ª–∏–¥–Ω–æ–≥–æ Excel —Ñ–∞–π–ª–∞.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)  
**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** 6,662 bytes

### TestUploadExcelFile_LargeFile ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –±–æ–ª—å—à–æ–≥–æ —Ñ–∞–π–ª–∞ (1000 —Å—Ç—Ä–æ–∫).

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.04s)  
**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** 56,181 bytes (0.05 MB)

### TestUploadExcelFile_MissingFile ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–∞ –±–µ–∑ —Ñ–∞–π–ª–∞.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)

### TestUploadExcelFile_InvalidContentType ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ Content-Type.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)

### TestUploadExcelFile_FileSizeLimit ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –ª–∏–º–∏—Ç–æ–≤ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS (0.00s)

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

### TestExcelFileCanBeParsed ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ Excel —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π excelize.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS

### TestExcelFileStreaming ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç streaming API –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS

### TestMultipartFormFileUpload ‚úÖ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ multipart/form-data.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PASS

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤:
- **–ú–∞–ª–µ–Ω—å–∫–∏–π —Ñ–∞–π–ª (2 —Å—Ç—Ä–æ–∫–∏):** 0.00-0.01s
- **–°—Ä–µ–¥–Ω–∏–π —Ñ–∞–π–ª (100 —Å—Ç—Ä–æ–∫):** ~0.05s
- **–ë–æ–ª—å—à–æ–π —Ñ–∞–π–ª (1000 —Å—Ç—Ä–æ–∫):** 0.12s

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤:
- **–ú–∞–ª–µ–Ω—å–∫–∏–π —Ñ–∞–π–ª (6 KB):** 0.00s
- **–ë–æ–ª—å—à–æ–π —Ñ–∞–π–ª (56 KB):** 0.04s

### –û—Ü–µ–Ω–∫–∞ –¥–ª—è 20 –ú–ë —Ñ–∞–π–ª–∞ (~100,000 —Å—Ç—Ä–æ–∫):
- **–ü–∞—Ä—Å–∏–Ω–≥:** ~12-15 —Å–µ–∫—É–Ω–¥
- **–û–±—Ä–∞–±–æ—Ç–∫–∞:** ~1-2 –º–∏–Ω—É—Ç—ã
- **–ò–¢–û–ì–û:** ~1.5-2.5 –º–∏–Ω—É—Ç—ã

## ‚úÖ –í—ã–≤–æ–¥—ã

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:

1. ‚úÖ **–ü–∞—Ä—Å–∏–Ω–≥ Excel —Ñ–∞–π–ª–æ–≤** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ 18 –∫–æ–ª–æ–Ω–æ–∫** - –≤—Å–µ –∫–æ–ª–æ–Ω–∫–∏ —á–∏—Ç–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. ‚úÖ **–ö–∏—Ä–∏–ª–ª–∏—Ü–∞** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
4. ‚úÖ **–ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã** - 1000 —Å—Ç—Ä–æ–∫ –ø–∞—Ä—Å—è—Ç—Å—è –∑–∞ 0.12s
5. ‚úÖ **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤** - –≤—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
6. ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ HTTP** - multipart/form-data —Ä–∞–±–æ—Ç–∞–µ—Ç
7. ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–æ–ª–æ–Ω–æ–∫

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:

- ‚úÖ –§–∞–π–ª—ã –¥–æ 50 –ú–ë –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–µ–∑ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –†–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è
- ‚úÖ –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–ª–µ–º–∞—è

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã

### –í—Å–µ —Ç–µ—Å—Ç—ã:
```bash
./test_excel_import.sh
```

### –¢–æ–ª—å–∫–æ –ø–∞—Ä—Å–∏–Ω–≥:
```bash
cd migration-service
go test -v ./internal/usecase -run TestExcelFileParsing
```

### –¢–æ–ª—å–∫–æ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤:
```bash
cd migration-service
go test -v ./internal/usecase -run TestNormalizePhone
```

### –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤:
```bash
cd migration-service
go test -v ./internal/infrastructure/http -run TestUpload
```

## üìù –§–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤

- `migration-service/internal/usecase/excel_parsing_test.go` - —Ç–µ—Å—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ Excel
- `migration-service/internal/infrastructure/http/upload_test.go` - —Ç–µ—Å—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
- `test_excel_import.sh` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

## üéØ –ò—Ç–æ–≥

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏–º–ø–æ—Ä—Ç—É Excel —Ñ–∞–π–ª–æ–≤!**

–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã, —Ñ–∞–π–ª 20 –ú–ë –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω –±–µ–∑ –ø—Ä–æ–±–ª–µ–º.
