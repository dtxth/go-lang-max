# –¶–∏—Ñ—Ä–æ–≤–æ–π –í—É–∑ - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞–º–∏, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏, —á–∞—Ç–∞–º–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º–∏ –¥–ª—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "–¶–∏—Ñ—Ä–æ–≤–æ–π –≤—É–∑" –Ω–∞ –±–∞–∑–µ Go –∏ MAX Messenger.

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
- **–†–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏ ABAC** (Attribute-Based Access Control) —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –ø—Ä–∞–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å MAX Messenger** —á–µ—Ä–µ–∑ –ø–æ–ª—É—á–µ–Ω–∏–µ MAX_id –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- **–ú–∏–≥—Ä–∞—Ü–∏–∏ 150,000+ —á–∞—Ç–æ–≤** –∏–∑ —Ç—Ä–µ—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—É–∑–æ–≤** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º–∏, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ –∏ —á–∞—Ç–∞–º–∏
- **–ß–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ domain, usecase, infrastructure —Å–ª–æ–∏

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å ABAC** - Superadmin, Curator, Operator —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ MAX_id** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MAX Messenger Bot API  
‚úÖ **–ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ MAX_id –¥–ª—è —Ç—ã—Å—è—á —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤  
‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ò–º–ø–æ—Ä—Ç –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, Google Sheets –∏ Excel  
‚úÖ **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - University ‚Üí Branch ‚Üí Faculty ‚Üí Group ‚Üí Chat  
‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–æ–ª—è–º** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º  
‚úÖ **–ü–æ–∏—Å–∫ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è** - –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞  
‚úÖ **gRPC –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è** - –í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏  
‚úÖ **Retry –ª–æ–≥–∏–∫–∞** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ —Å–±–æ—è—Ö —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π  
‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - JSON –ª–æ–≥–∏ —Å request_id –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏  

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 6 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤:

### 1. Auth Service (–ø–æ—Ä—Ç 8080, gRPC: 9090)
**–°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ABAC**

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ JWT —Ç–æ–∫–µ–Ω–∞–º–∏ (access –∏ refresh)
- **–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å**: Superadmin, Curator, Operator
- **ABAC –≤–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (—Ä–æ–ª—å, —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç, —Ñ–∏–ª–∏–∞–ª, —Ñ–∞–∫—É–ª—å—Ç–µ—Ç)
- **gRPC API**: ValidateToken, GetUserPermissions, AssignRole
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (university_id, branch_id, faculty_id)
- –ò–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–∞–≤: Superadmin > Curator > Operator

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞](./auth-service/internal/usecase/validate_permission.go)
- [–¢–µ—Å—Ç—ã ABAC](./auth-service/internal/usecase/validate_permission_test.go)

### 2. Employee Service (–ø–æ—Ä—Ç 8081, gRPC: 9091)
**–°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Ä–æ–ª–µ–π –∏ MAX_id**

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤—É–∑–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ MAX_id** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
- **–ü–∞–∫–µ—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ MAX_id** –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (–¥–æ 100 –∑–∞ —Ä–∞–∑)
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π** —Å Auth Service –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏
- **–ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Ä–æ–ª—è–º** (Curator –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –≤—É–∑)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤ –ø–æ INN
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞–º–∏ (name, INN, KPP)

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ —Å —Ä–æ–ª—å—é](./employee-service/internal/usecase/create_employee_with_role.go)
- [–ü–∞–∫–µ—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ MAX_id](./employee-service/internal/usecase/batch_update_max_id.go)
- [–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ MaxBot](./employee-service/MAXBOT_INTEGRATION_EXAMPLES.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π](./employee-service/BATCH_UPDATE_IMPLEMENTATION.md)

### 3. Chat Service (–ø–æ—Ä—Ç 8082, gRPC: 9092)
**–°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Ç–∞–º–∏ —Å —Ä–æ–ª–µ–≤–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π**

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–æ–≤—ã–º–∏ —á–∞—Ç–∞–º–∏
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–æ–ª—è–º**: Superadmin (–≤—Å–µ), Curator (—Å–≤–æ–π –≤—É–∑), Operator (—Å–≤–æ–π —Ñ–∏–ª–∏–∞–ª/—Ñ–∞–∫—É–ª—å—Ç–µ—Ç)
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ–º MAX_id
- **–ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫** –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —á–∞—Ç–∞ (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** —Å –ª–∏–º–∏—Ç–æ–º –¥–æ 100 –∑–∞–ø–∏—Å–µ–π
- –ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: admin_panel, bot_registrar, academic_group

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–æ–ª—è–º](./chat-service/internal/usecase/list_chats_with_role_filter.go)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏](./chat-service/ROLE_BASED_FILTERING_IMPLEMENTATION.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏](./chat-service/PAGINATION_IMPLEMENTATION.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞](./chat-service/CHAT_SEARCH_IMPLEMENTATION.md)

### 4. Structure Service (–ø–æ—Ä—Ç 8083, gRPC: 9093)
**–°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –≤—É–∑–æ–≤**

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: University ‚Üí Branch ‚Üí Faculty ‚Üí Group ‚Üí Chat
- **–ò–º–ø–æ—Ä—Ç –∏–∑ Excel** —Å –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∏ —á–∞—Ç–∞–º–∏
- **–°–≤—è–∑—å –≥—Ä—É–ø–ø —Å —á–∞—Ç–∞–º–∏** —á–µ—Ä–µ–∑ chat_id
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π** (department_managers)
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å –¥–µ—Ç–∞–ª—è–º–∏ —á–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ gRPC
- –ê–ª—Ñ–∞–≤–∏—Ç–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –∏–º–ø–æ—Ä—Ç —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–ò–º–ø–æ—Ä—Ç –∏–∑ Excel](./structure-service/internal/usecase/import_structure_from_excel.go)
- [–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏](./structure-service/internal/usecase/get_university_structure.go)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏](./structure-service/STRUCTURE_HIERARCHY_IMPLEMENTATION.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ Excel](./structure-service/EXCEL_IMPORT_IMPLEMENTATION.md)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏](./structure-service/DEPARTMENT_MANAGERS_IMPLEMENTATION.md)

### 5. MaxBot Service (gRPC: 9095)
**–°–µ—Ä–≤–∏—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å MAX Messenger Bot API**

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (GetUserByPhone)
- **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –¥–æ 100 –Ω–æ–º–µ—Ä–æ–≤ –∑–∞ –∑–∞–ø—Ä–æ—Å (BatchGetUsersByPhone)
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤** –≤ —Ñ–æ—Ä–º–∞—Ç E.164 (+7XXXXXXXXXX)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (8, 9, +7)
- –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ—á–∏—Å–ª–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ (–ø—Ä–æ–±–µ–ª—ã, –¥–µ—Ñ–∏—Å—ã, —Å–∫–æ–±–∫–∏)
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π max-bot-api-client-go

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [README MaxBot Service](./maxbot-service/README.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](./maxbot-service/INTEGRATION_GUIDE.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π](./maxbot-service/BATCH_OPERATIONS_IMPLEMENTATION.md)
- [–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤](./maxbot-service/internal/usecase/normalize_phone.go)

### 6. Migration Service (–ø–æ—Ä—Ç 8084)
**–°–µ—Ä–≤–∏—Å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (6,000 —á–∞—Ç–æ–≤ –∏–∑ –∞–¥–º–∏–Ω–∫–∏)
- **–ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ Google Sheets** (—á–∞—Ç—ã –æ—Ç –±–æ—Ç–∞-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
- **–ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ Excel** (155,000+ —á–∞—Ç–æ–≤ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö –≥—Ä—É–ø–ø)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ (migration_jobs)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ (migration_errors)
- –°–æ–∑–¥–∞–Ω–∏–µ/–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤ –ø–æ INN+KPP
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å —á–∞—Ç–∞–º–∏

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [README Migration Service](./migration-service/README.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–∏](./migration-service/MIGRATION_SERVICE_IMPLEMENTATION.md)
- [–ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](./migration-service/internal/usecase/migrate_from_database.go)
- [–ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ Google Sheets](./migration-service/internal/usecase/migrate_from_google_sheets.go)
- [–ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ Excel](./migration-service/internal/usecase/migrate_from_excel.go)

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–Ø–∑—ã–∫**: Go 1.21+
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL 15
- **API**: REST (HTTP) + gRPC
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: JWT (RS256)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker, Docker Compose
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API**: Swagger/OpenAPI
- **–ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î**: golang-migrate
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: Structured JSON logs
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Go testing, testify, gopter (property-based testing)
- **–í–Ω–µ—à–Ω–∏–µ API**: MAX Messenger Bot API

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go 1.21+
- Docker –∏ Docker Compose
- protoc (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ gRPC –∫–æ–¥–∞)
- PostgreSQL 15 (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Compose)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ protoc (macOS)
brew install protobuf

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Go –ø–ª–∞–≥–∏–Ω–æ–≤ –¥–ª—è gRPC
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è gRPC –∫–æ–¥–∞

```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
chmod +x generate_proto.sh
./generate_proto.sh
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f auth-service

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º volumes (–æ—á–∏—Å—Ç–∫–∞ –ë–î)
docker-compose down -v
```

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º:
- **Auth Service**: http://localhost:8080 (gRPC: 9090)
- **Employee Service**: http://localhost:8081 (gRPC: 9091)
- **Chat Service**: http://localhost:8082 (gRPC: 9092)
- **Structure Service**: http://localhost:8083 (gRPC: 9093)
- **Migration Service**: http://localhost:8084
- **MaxBot Service**: gRPC: 9095

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoints
curl http://localhost:8080/health  # Auth Service
curl http://localhost:8081/health  # Employee Service
curl http://localhost:8082/health  # Chat Service
curl http://localhost:8083/health  # Structure Service
curl http://localhost:8084/health  # Migration Service
```

### –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ (–±–µ–∑ Docker)

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–µ—Ä–≤–∏—Å–∞
cd auth-service  # –∏–ª–∏ chat-service, employee-service, structure-service

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
go mod download

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
go run cmd/auth/main.go  # –∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø—É—Ç—å –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
go-lang-max/
‚îú‚îÄ‚îÄ auth-service/              # –°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ ABAC
‚îÇ   ‚îú‚îÄ‚îÄ api/proto/             # gRPC proto —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ cmd/auth/              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/            # –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (User, Role, Permission)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usecase/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (ValidatePermission, AssignRole)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ grpc/          # gRPC —Å–µ—Ä–≤–µ—Ä –∏ handlers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ http/          # HTTP REST API
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repository/    # PostgreSQL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt/           # JWT token manager
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ errors/        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config/            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ migrations/            # SQL –º–∏–≥—Ä–∞—Ü–∏–∏ (roles, user_roles)
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îÇ
‚îú‚îÄ‚îÄ employee-service/          # –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/            # Employee, University, BatchUpdateJob
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usecase/           # CreateEmployeeWithRole, BatchUpdateMaxId
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth/          # Auth Service gRPC client
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ max/           # MaxBot Service gRPC client
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # SQL –º–∏–≥—Ä–∞—Ü–∏–∏ (role, max_id, batch_update_jobs)
‚îÇ
‚îú‚îÄ‚îÄ chat-service/              # –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/            # Chat, Administrator, ChatFilter
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usecase/           # ListChatsWithRoleFilter, AddAdministrator
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth/          # Auth Service gRPC client
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ max/           # MaxBot Service gRPC client
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ structure-service/         # –°–µ—Ä–≤–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—É–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/            # Structure, DepartmentManager
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usecase/           # ImportFromExcel, GetUniversityStructure
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ excel/         # Excel parser
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ grpc/          # Chat Service gRPC client
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # SQL –º–∏–≥—Ä–∞—Ü–∏–∏ (department_managers, chat_url)
‚îÇ
‚îú‚îÄ‚îÄ maxbot-service/            # –°–µ—Ä–≤–∏—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å MAX Messenger
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/            # MAX API client interface
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usecase/           # BatchGetUsersByPhone, NormalizePhone
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ maxapi/        # MAX API HTTP client
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ grpc/          # gRPC —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ api/proto/             # gRPC proto —Ñ–∞–π–ª—ã
‚îÇ
‚îú‚îÄ‚îÄ migration-service/         # –°–µ—Ä–≤–∏—Å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/            # MigrationJob, MigrationError
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usecase/           # MigrateFromDatabase, MigrateFromExcel
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ chat/          # Chat Service gRPC client
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ structure/     # Structure Service gRPC client
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # SQL –º–∏–≥—Ä–∞—Ü–∏–∏ (migration_jobs, migration_errors)
‚îÇ
‚îú‚îÄ‚îÄ integration-tests/         # End-to-end –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ employee_integration_test.go
‚îÇ   ‚îú‚îÄ‚îÄ chat_integration_test.go
‚îÇ   ‚îú‚îÄ‚îÄ structure_integration_test.go
‚îÇ   ‚îú‚îÄ‚îÄ migration_integration_test.go
‚îÇ   ‚îú‚îÄ‚îÄ grpc_integration_test.go
‚îÇ   ‚îî‚îÄ‚îÄ run_tests.sh
‚îÇ
‚îú‚îÄ‚îÄ .kiro/specs/               # –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ digital-university-mvp-completion/
‚îÇ       ‚îú‚îÄ‚îÄ requirements.md    # –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (EARS —Ñ–æ—Ä–º–∞—Ç)
‚îÇ       ‚îú‚îÄ‚îÄ design.md          # –î–∏–∑–∞–π–Ω –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚îÇ       ‚îî‚îÄ‚îÄ tasks.md           # –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml         # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ generate_proto.sh          # –°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ gRPC –∫–æ–¥–∞
‚îú‚îÄ‚îÄ GRPC_SETUP.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ gRPC
‚îú‚îÄ‚îÄ MIGRATIONS.md              # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏—è–º –ë–î
‚îî‚îÄ‚îÄ README.md                  # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## gRPC –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

–°–µ—Ä–≤–∏—Å—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —á–µ—Ä–µ–∑ gRPC –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–æ–≤—Ç–æ—Ä–∞–º–∏ –ø—Ä–∏ —Å–±–æ—è—Ö:

### –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```
Employee Service ‚îÄ‚îÄgRPC‚îÄ‚îÄ> Auth Service (ValidateToken, AssignRole)
                 ‚îî‚îÄ‚îÄgRPC‚îÄ‚îÄ> MaxBot Service (GetUserByPhone, BatchGetUsersByPhone)

Chat Service ‚îÄ‚îÄgRPC‚îÄ‚îÄ> Auth Service (ValidateToken, GetUserPermissions)
             ‚îî‚îÄ‚îÄgRPC‚îÄ‚îÄ> MaxBot Service (GetUserByPhone)

Structure Service ‚îÄ‚îÄgRPC‚îÄ‚îÄ> Chat Service (GetChat)
                  ‚îî‚îÄ‚îÄgRPC‚îÄ‚îÄ> Employee Service (GetEmployee)

Migration Service ‚îÄ‚îÄgRPC‚îÄ‚îÄ> Chat Service (CreateChat)
                  ‚îî‚îÄ‚îÄgRPC‚îÄ‚îÄ> Structure Service (ImportStructure)
```

### –û—Å–Ω–æ–≤–Ω—ã–µ gRPC –º–µ—Ç–æ–¥—ã

**Auth Service (–ø–æ—Ä—Ç 9090):**
- `ValidateToken(token)` ‚Üí user_id, role, university_id, branch_id, faculty_id
- `GetUserPermissions(user_id)` ‚Üí —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- `AssignRole(user_id, role, context)` ‚Üí —É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞

**MaxBot Service (–ø–æ—Ä—Ç 9095):**
- `GetUserByPhone(phone)` ‚Üí MAX_id –∏–ª–∏ –æ—à–∏–±–∫–∞
- `BatchGetUsersByPhone(phones[])` ‚Üí –º–∞—Å—Å–∏–≤ phone‚ÜíMAX_id mappings
- `NormalizePhone(phone)` ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –≤ E.164

**Chat Service (–ø–æ—Ä—Ç 9092):**
- `GetChat(chat_id)` ‚Üí –¥–µ—Ç–∞–ª–∏ —á–∞—Ç–∞
- `CreateChat(chat_data)` ‚Üí —Å–æ–∑–¥–∞–Ω–Ω—ã–π —á–∞—Ç

**Employee Service (–ø–æ—Ä—Ç 9091):**
- `GetEmployee(employee_id)` ‚Üí –¥–µ—Ç–∞–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞

### Retry –ª–æ–≥–∏–∫–∞

–í—Å–µ gRPC –≤—ã–∑–æ–≤—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã:
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫**: 3
- **–ó–∞–¥–µ—Ä–∂–∫–∏**: 1s, 2s, 4s (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∫–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
- **–û—à–∏–±–∫–∞**: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –Ω–µ—É–¥–∞—á–∏

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: [GRPC_RETRY_IMPLEMENTATION.md](./GRPC_RETRY_IMPLEMENTATION.md)

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ gRPC](./GRPC_SETUP.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è retry](./GRPC_RETRY_IMPLEMENTATION.md)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã gRPC](./integration-tests/grpc_integration_test.go)

## –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL (Database per Service pattern):

| –°–µ—Ä–≤–∏—Å | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | –ü–æ—Ä—Ç | –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã |
|--------|-------------|------|------------------|
| Auth Service | auth-db | 5432 | users, roles, user_roles, refresh_tokens |
| Employee Service | employee-db | 5433 | employees, universities, batch_update_jobs |
| Chat Service | chat-db | 5434 | chats, administrators |
| Structure Service | structure-db | 5435 | universities, branches, faculties, groups, department_managers |
| Migration Service | migration-db | 5436 | migration_jobs, migration_errors |

### –ú–∏–≥—Ä–∞—Ü–∏–∏

–ú–∏–≥—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ Docker Compose.

**–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏:**

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
cd auth-service
make migrate-up

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
make migrate-down

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
make migrate-status
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏—è–º](./MIGRATIONS.md)
- [–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π](./verify_migrations.sh)
- [–°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π](./test_migrations.sh)

## API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Swagger UI

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤, Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:

- **Auth Service**: http://localhost:8080/swagger/index.html
- **Employee Service**: http://localhost:8081/swagger/index.html
- **Chat Service**: http://localhost:8082/swagger/index.html
- **Structure Service**: http://localhost:8083/swagger/index.html
- **Migration Service**: http://localhost:8084/swagger/index.html

üìñ **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger:** [SWAGGER_ENDPOINTS.md](./SWAGGER_ENDPOINTS.md)

### –û—Å–Ω–æ–≤–Ω—ã–µ API endpoints

#### Auth Service (–ø–æ—Ä—Ç 8080)

```
POST   /auth/register          - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST   /auth/login             - –í—Ö–æ–¥ (–ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–æ–≤)
POST   /auth/refresh           - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞
POST   /auth/logout            - –í—ã—Ö–æ–¥ (–∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è refresh —Ç–æ–∫–µ–Ω–∞)
POST   /roles/assign           - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
GET    /users/{id}/permissions - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GET    /health                 - Health check
```

#### Employee Service (–ø–æ—Ä—Ç 8081)

```
POST   /employees                    - –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (—Å —Ä–æ–ª—å—é –∏ MAX_id)
GET    /employees                    - –ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Ä–æ–ª—è–º)
GET    /employees/{id}               - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
PUT    /employees/{id}               - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–æ–ª–∏)
DELETE /employees/{id}               - –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–æ—Ç–∑—ã–≤ –ø—Ä–∞–≤)
POST   /employees/batch-update-maxid - –ü–∞–∫–µ—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ MAX_id
GET    /employees/batch-status       - –°—Ç–∞—Ç—É—Å –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
GET    /universities                 - –°–ø–∏—Å–æ–∫ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤
GET    /health                       - Health check
```

#### Chat Service (–ø–æ—Ä—Ç 8082)

```
POST   /chats                  - –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞
GET    /chats                  - –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Ä–æ–ª—è–º –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π)
GET    /chats/search           - –ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
GET    /chats/{id}             - –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Ç–∞
PUT    /chats/{id}             - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
DELETE /chats/{id}             - –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–∞
POST   /chats/{id}/admins      - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤)
DELETE /chats/{id}/admins/{aid} - –£–¥–∞–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–∑–∞—â–∏—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ)
GET    /health                 - Health check
```

#### Structure Service (–ø–æ—Ä—Ç 8083)

```
POST   /import/excel                  - –ò–º–ø–æ—Ä—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑ Excel
GET    /universities/{id}/structure   - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏ –≤—É–∑–∞
POST   /departments/managers          - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
DELETE /departments/managers/{id}     - –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
GET    /departments/managers          - –°–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π
GET    /universities                  - –°–ø–∏—Å–æ–∫ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤
GET    /branches                      - –°–ø–∏—Å–æ–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤
GET    /faculties                     - –°–ø–∏—Å–æ–∫ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤
GET    /groups                        - –°–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø
GET    /health                        - Health check
```

#### Migration Service (–ø–æ—Ä—Ç 8084)

```
POST   /migration/database      - –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (6,000 —á–∞—Ç–æ–≤)
POST   /migration/google-sheets - –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ Google Sheets
POST   /migration/excel         - –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ Excel (155,000+ —á–∞—Ç–æ–≤)
GET    /migration/jobs/{id}     - –°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–∏
GET    /migration/jobs          - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π
GET    /health                  - Health check
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–ª—É—á–µ–Ω–∏–µ–º MAX_id:**

```bash
curl -X POST http://localhost:8081/employees \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <JWT_TOKEN>" \
  -d '{
    "first_name": "–ò–≤–∞–Ω",
    "last_name": "–ò–≤–∞–Ω–æ–≤",
    "phone": "+79991234567",
    "role": "operator",
    "university": {
      "name": "–ú–ì–£",
      "inn": "7714357576",
      "kpp": "771401001"
    }
  }'
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Ä–æ–ª–∏:**

```bash
# Curator —É–≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —á–∞—Ç—ã —Å–≤–æ–µ–≥–æ –≤—É–∑–∞
curl -X GET "http://localhost:8082/chats?limit=50&offset=0" \
  -H "Authorization: Bearer <CURATOR_JWT_TOKEN>"
```

**–ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤:**

```bash
curl -X GET "http://localhost:8082/chats/search?q=–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞" \
  -H "Authorization: Bearer <JWT_TOKEN>"
```

**–ò–º–ø–æ—Ä—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑ Excel:**

```bash
curl -X POST http://localhost:8083/import/excel \
  -H "Authorization: Bearer <JWT_TOKEN>" \
  -F "file=@structure.xlsx"
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Auth Service
```bash
DATABASE_URL=postgres://user:password@localhost:5432/auth_db?sslmode=disable
HTTP_ADDR=:8080                    # –ê–¥—Ä–µ—Å HTTP —Å–µ—Ä–≤–µ—Ä–∞
GRPC_PORT=9090                     # –ü–æ—Ä—Ç gRPC —Å–µ—Ä–≤–µ—Ä–∞
JWT_ACCESS_SECRET=your-secret-key  # –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è access —Ç–æ–∫–µ–Ω–æ–≤
JWT_REFRESH_SECRET=your-secret-key # –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è refresh —Ç–æ–∫–µ–Ω–æ–≤
ACCESS_MINUTES=15                  # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ access —Ç–æ–∫–µ–Ω–∞ (–º–∏–Ω—É—Ç—ã)
REFRESH_HOURS=168                  # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ refresh —Ç–æ–∫–µ–Ω–∞ (—á–∞—Å—ã)
LOG_LEVEL=info                     # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (debug, info, warn, error)
```

### Employee Service
```bash
DATABASE_URL=postgres://user:password@localhost:5433/employee_db?sslmode=disable
PORT=8081                          # –ü–æ—Ä—Ç HTTP —Å–µ—Ä–≤–µ—Ä–∞
GRPC_PORT=9091                     # –ü–æ—Ä—Ç gRPC —Å–µ—Ä–≤–µ—Ä–∞
AUTH_SERVICE_GRPC=localhost:9090   # –ê–¥—Ä–µ—Å Auth Service gRPC
MAXBOT_SERVICE_GRPC=localhost:9095 # –ê–¥—Ä–µ—Å MaxBot Service gRPC
LOG_LEVEL=info
```

### Chat Service
```bash
DATABASE_URL=postgres://user:password@localhost:5434/chat_db?sslmode=disable
PORT=8082                          # –ü–æ—Ä—Ç HTTP —Å–µ—Ä–≤–µ—Ä–∞
GRPC_PORT=9092                     # –ü–æ—Ä—Ç gRPC —Å–µ—Ä–≤–µ—Ä–∞
AUTH_SERVICE_GRPC=localhost:9090   # –ê–¥—Ä–µ—Å Auth Service gRPC
MAXBOT_SERVICE_GRPC=localhost:9095 # –ê–¥—Ä–µ—Å MaxBot Service gRPC
LOG_LEVEL=info
```

### Structure Service
```bash
DATABASE_URL=postgres://user:password@localhost:5435/structure_db?sslmode=disable
PORT=8083                          # –ü–æ—Ä—Ç HTTP —Å–µ—Ä–≤–µ—Ä–∞
GRPC_PORT=9093                     # –ü–æ—Ä—Ç gRPC —Å–µ—Ä–≤–µ—Ä–∞
CHAT_SERVICE_GRPC=localhost:9092   # –ê–¥—Ä–µ—Å Chat Service gRPC
EMPLOYEE_SERVICE_GRPC=localhost:9091 # –ê–¥—Ä–µ—Å Employee Service gRPC
LOG_LEVEL=info
```

### MaxBot Service
```bash
MAX_API_TOKEN=your-max-api-token   # –¢–æ–∫–µ–Ω –¥–ª—è MAX Messenger Bot API (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
MAX_API_URL=https://api.max.ru     # URL MAX Messenger API
MAX_API_TIMEOUT=5s                 # –¢–∞–π–º–∞—É—Ç –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
GRPC_PORT=9095                     # –ü–æ—Ä—Ç gRPC —Å–µ—Ä–≤–µ—Ä–∞
LOG_LEVEL=info
```

### Migration Service
```bash
DATABASE_URL=postgres://user:password@localhost:5436/migration_db?sslmode=disable
PORT=8084                          # –ü–æ—Ä—Ç HTTP —Å–µ—Ä–≤–µ—Ä–∞
CHAT_SERVICE_GRPC=localhost:9092   # –ê–¥—Ä–µ—Å Chat Service gRPC
STRUCTURE_SERVICE_GRPC=localhost:9093 # –ê–¥—Ä–µ—Å Structure Service gRPC
GOOGLE_SHEETS_CREDENTIALS_PATH=/path/to/credentials.json # –ü—É—Ç—å –∫ credentials –¥–ª—è Google Sheets API
LOG_LEVEL=info
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ `docker-compose.yml` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ Docker.

## –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º (ABAC)

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Attribute-Based Access Control (ABAC) —Å —Ç—Ä–µ–º—è —Ä–æ–ª—è–º–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏.

### –†–æ–ª–∏

| –†–æ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ |
|------|----------|---------------|
| **Superadmin** | –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å VK | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º –≤—Å–µ—Ö —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤ |
| **Curator** | –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å –≤—É–∑–∞ | –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –¥–∞–Ω–Ω—ã–º —Å–≤–æ–µ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ |
| **Operator** | –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è | –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –¥–∞–Ω–Ω—ã–º —Å–≤–æ–µ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞/—Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞ |

### –ò–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–∞–≤

```
Superadmin (–≤—Å–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã)
    ‚Üì
Curator (–æ–¥–∏–Ω —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç)
    ‚Üì
Operator (–æ–¥–∏–Ω —Ñ–∏–ª–∏–∞–ª –∏–ª–∏ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç)
```

–í—ã—Å—à–∏–µ —Ä–æ–ª–∏ –∏–º–µ—é—Ç –≤—Å–µ –ø—Ä–∞–≤–∞ –Ω–∏–∑—à–∏—Ö —Ä–æ–ª–µ–π (–∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∞).

### –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã

–ö–∞–∂–¥–∞—è —Ä–æ–ª—å (–∫—Ä–æ–º–µ Superadmin) –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:

```go
type UserRole struct {
    UserID       int
    Role         string  // "superadmin", "curator", "operator"
    UniversityID *int    // NULL –¥–ª—è superadmin
    BranchID     *int    // NULL –¥–ª—è curator –∏ superadmin
    FacultyID    *int    // NULL –¥–ª—è curator –∏ superadmin
}
```

### –ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

**–°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤:**
- Superadmin: `SELECT * FROM chats`
- Curator: `SELECT * FROM chats WHERE university_id = ?`
- Operator: `SELECT * FROM chats WHERE branch_id = ? OR faculty_id = ?`

**–ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:**
- Superadmin: –≤—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
- Curator: —Ç–æ–ª—å–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å–≤–æ–µ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞
- Operator: —Ç–æ–ª—å–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å–≤–æ–µ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π

```bash
# –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ Curator –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞
curl -X POST http://localhost:8080/roles/assign \
  -H "Authorization: Bearer <SUPERADMIN_TOKEN>" \
  -d '{
    "user_id": 123,
    "role": "curator",
    "university_id": 1
  }'

# –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ Operator –¥–ª—è —Ñ–∏–ª–∏–∞–ª–∞
curl -X POST http://localhost:8080/roles/assign \
  -H "Authorization: Bearer <CURATOR_TOKEN>" \
  -d '{
    "user_id": 456,
    "role": "operator",
    "branch_id": 10
  }'
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞](./auth-service/internal/usecase/validate_permission.go)
- [–¢–µ—Å—Ç—ã ABAC](./auth-service/internal/usecase/validate_permission_test.go)
- [–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–∞—Ç–æ–≤ –ø–æ —Ä–æ–ª—è–º](./chat-service/ROLE_BASED_FILTERING_IMPLEMENTATION.md)

## –ü—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é –±–æ–ª–µ–µ 150,000 —á–∞—Ç–æ–≤ –∏–∑ —Ç—Ä–µ—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

| –ò—Å—Ç–æ—á–Ω–∏–∫ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –¢–∏–ø | Source –º–µ—Ç–∫–∞ |
|----------|------------|-----|--------------|
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–∫–∏ | ~6,000 | –ß–∞—Ç—ã –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞–¥–º–∏–Ω–∫–∏ | `admin_panel` |
| Google Sheets | –ü–µ—Ä–µ–º–µ–Ω–Ω–æ–µ | –ß–∞—Ç—ã –æ—Ç –±–æ—Ç–∞-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ | `bot_registrar` |
| Excel —Ñ–∞–π–ª—ã | 155,000+ | –ß–∞—Ç—ã –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö –≥—Ä—É–ø–ø | `academic_group` |

### –≠—Ç–∞–ø—ã –º–∏–≥—Ä–∞—Ü–∏–∏

#### 1. –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (admin_panel)

```bash
# –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏
curl -X POST http://localhost:8084/migration/database \
  -H "Authorization: Bearer <TOKEN>" \
  -d '{
    "source_db_url": "postgres://user:pass@host:5432/old_db"
  }'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl http://localhost:8084/migration/jobs/1
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: INN, –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞, URL, —Ç–µ–ª–µ—Ñ–æ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –ü–æ–∏—Å–∫/—Å–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ –ø–æ INN
3. –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞ —Å source='admin_panel'
4. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
5. –ü–æ–ª—É—á–µ–Ω–∏–µ MAX_id –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~10 –º–∏–Ω—É—Ç

#### 2. –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ Google Sheets (bot_registrar)

```bash
curl -X POST http://localhost:8084/migration/google-sheets \
  -H "Authorization: Bearer <TOKEN>" \
  -d '{
    "sheet_id": "1abc...xyz",
    "credentials_path": "/path/to/credentials.json"
  }'
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å Google Sheets API
2. –ß—Ç–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫: INN, KPP, URL, —Ç–µ–ª–µ—Ñ–æ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –ü–æ–∏—Å–∫/—Å–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ –ø–æ INN+KPP
4. –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞ —Å source='bot_registrar'
5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –∏ –æ—à–∏–±–æ–∫

#### 3. –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ Excel (academic_group)

```bash
curl -X POST http://localhost:8084/migration/excel \
  -H "Authorization: Bearer <TOKEN>" \
  -F "file=@academic_groups.xlsx"
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ Excel –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
2. –ü–∞—Ä—Å–∏–Ω–≥: —Ç–µ–ª–µ—Ñ–æ–Ω, INN, FOIV, –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ñ–∏–ª–∏–∞–ª, KPP, —Ñ–∞–∫—É–ª—å—Ç–µ—Ç, –∫—É—Ä—Å, –Ω–æ–º–µ—Ä –≥—Ä—É–ø–ø—ã, –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞, URL
3. –í—ã–∑–æ–≤ Structure Service –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ (University ‚Üí Branch ‚Üí Faculty ‚Üí Group)
4. –í—ã–∑–æ–≤ Chat Service –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞ —Å source='academic_group'
5. –°–≤—è–∑—ã–≤–∞–Ω–∏–µ Group —Å Chat —á–µ—Ä–µ–∑ chat_id

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2-3 —á–∞—Å–∞ –¥–ª—è 155,000 –∑–∞–ø–∏—Å–µ–π

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π
curl http://localhost:8084/migration/jobs

# –î–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
curl http://localhost:8084/migration/jobs/1

# –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
{
  "id": 1,
  "source_type": "excel",
  "status": "running",
  "total": 155000,
  "processed": 50000,
  "failed": 123,
  "started_at": "2024-01-15T10:00:00Z",
  "estimated_completion": "2024-01-15T13:00:00Z"
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –æ—à–∏–±–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `migration_errors`:

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–∏
curl http://localhost:8084/migration/jobs/1/errors

# –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
[
  {
    "record_identifier": "row_1234",
    "error_message": "Invalid INN format: 123",
    "created_at": "2024-01-15T10:05:00Z"
  }
]
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏](./QUICK_MIGRATION_GUIDE.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Migration Service](./migration-service/MIGRATION_SERVICE_IMPLEMENTATION.md)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏](./integration-tests/migration_integration_test.go)

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ Go –º–æ–¥—É–ª—å: `go mod init <service-name>`
3. –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ (cmd, internal, migrations)
4. –î–æ–±–∞–≤—å—Ç–µ Dockerfile –∏ docker-compose.yml –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞
5. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ—Ä–Ω–µ–≤–æ–π docker-compose.yml
6. –î–æ–±–∞–≤—å—Ç–µ proto —Ñ–∞–π–ª—ã –≤ `api/proto/`
7. –û–±–Ω–æ–≤–∏—Ç–µ `generate_proto.sh` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:**

```bash
./update_swagger.sh
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:**

```bash
cd <service-name>
make swagger

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
swag init -g cmd/<service>/main.go -o internal/infrastructure/http/docs
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```bash
# Auth Service
cd auth-service && make swagger

# Migration Service  
cd migration-service && make swagger
```

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Deployment)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

- Docker 20.10+
- Docker Compose 2.0+
- PostgreSQL 15
- –ú–∏–Ω–∏–º—É–º 4GB RAM
- 50GB –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è HTTPS

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

#### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

```bash
# –ü—Ä–∏–º–µ—Ä –¥–ª—è production
cp auth-service/.env.example auth-service/.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª—ã —Å production –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ JWT —Å–µ–∫—Ä–µ—Ç—ã (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ production DATABASE_URL —Å SSL
- –£–∫–∞–∂–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π MAX_API_TOKEN
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ LOG_LEVEL=info (–Ω–µ debug)

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
psql -U postgres -c "CREATE DATABASE auth_db;"
psql -U postgres -c "CREATE DATABASE employee_db;"
psql -U postgres -c "CREATE DATABASE chat_db;"
psql -U postgres -c "CREATE DATABASE structure_db;"
psql -U postgres -c "CREATE DATABASE migration_db;"

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
./verify_migrations.sh
```

#### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL/TLS

–î–ª—è production –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –∏ TLS –¥–ª—è gRPC:

```yaml
# docker-compose.prod.yml
services:
  auth-service:
    environment:
      - TLS_CERT_FILE=/certs/server.crt
      - TLS_KEY_FILE=/certs/server.key
    volumes:
      - ./certs:/certs:ro
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

#### Blue-Green Deployment

1. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ (Green)**
   ```bash
   docker-compose -f docker-compose.prod.yml up -d --scale auth-service=2
   ```

2. **Health checks**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
   for port in 8080 8081 8082 8083 8084; do
     curl -f http://localhost:$port/health || exit 1
   done
   ```

3. **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞**
   ```bash
   # –û–±–Ω–æ–≤–∏—Ç–µ load balancer –∏–ª–∏ API gateway
   # –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã
   ```

4. **–û—Ç–∫–∞—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏**
   ```bash
   docker-compose -f docker-compose.prod.yml down
   docker-compose -f docker-compose.prod.yml.backup up -d
   ```

### –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ backup
pg_dump -U postgres auth_db > auth_db_backup.sql

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
cd auth-service
make migrate-up

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
make migrate-status

# 4. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–∫–∞—Ç–∏—Ç–µ
make migrate-down
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç JSON –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```json
{
  "level": "info",
  "timestamp": "2024-01-15T10:00:00Z",
  "request_id": "abc-123",
  "service": "auth-service",
  "message": "User authenticated",
  "user_id": 123,
  "duration_ms": 45
}
```

#### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:
- Request rate (–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É)
- Response time (p50, p95, p99)
- Error rate (% –æ—à–∏–±–æ–∫)
- gRPC call success/failure rate
- Database connection pool usage
- Migration progress

#### Health checks

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç `/health` endpoint:

```bash
# –ü—Ä–∏–º–µ—Ä health check response
{
  "status": "healthy",
  "database": "connected",
  "grpc_services": {
    "auth_service": "available",
    "maxbot_service": "available"
  },
  "uptime_seconds": 3600
}
```

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
docker-compose -f docker-compose.prod.yml up -d --scale employee-service=3
docker-compose -f docker-compose.prod.yml up -d --scale chat-service=3
```

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é

- **Auth Service**: 2-3 –∏–Ω—Å—Ç–∞–Ω—Å–∞ (stateless, –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è)
- **Employee Service**: 2-4 –∏–Ω—Å—Ç–∞–Ω—Å–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏)
- **Chat Service**: 3-5 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ (–≤—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ)
- **Structure Service**: 1-2 –∏–Ω—Å—Ç–∞–Ω—Å–∞ (–Ω–∏–∑–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)
- **MaxBot Service**: 2-3 –∏–Ω—Å—Ç–∞–Ω—Å–∞ (–≤–Ω–µ—à–Ω–∏–µ API –≤—ã–∑–æ–≤—ã)
- **Migration Service**: 1 –∏–Ω—Å—Ç–∞–Ω—Å (—Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏)

#### Database Connection Pooling

```go
// –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è production
db.SetMaxOpenConns(25)
db.SetMaxIdleConns(5)
db.SetConnMaxLifetime(5 * time.Minute)
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

#### Checklist –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

- [ ] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–∏–ª—å–Ω—ã–µ JWT —Å–µ–∫—Ä–µ—Ç—ã
- [ ] –í–∫–ª—é—á–µ–Ω SSL/TLS –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω rate limiting
- [ ] –í–∫–ª—é—á–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è parameterized SQL queries
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã firewall –ø—Ä–∞–≤–∏–ª–∞
- [ ] –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
- [ ] –í–∫–ª—é—á–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã alerts –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- [ ] –†–µ–≥—É–ª—è—Ä–Ω—ã–µ backup –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

#### Rate Limiting

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ª–∏–º–∏—Ç—ã:
- 100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É –Ω–∞ IP
- 10 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å –¥–ª—è migration endpoints

### Backup –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π backup –≤—Å–µ—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
#!/bin/bash
DATE=$(date +%Y%m%d)
for db in auth_db employee_db chat_db structure_db migration_db; do
  pg_dump -U postgres $db | gzip > /backups/${db}_${DATE}.sql.gz
done

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup
gunzip < /backups/auth_db_20240115.sql.gz | psql -U postgres auth_db
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏—è–º](./MIGRATIONS.md)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](./MONITORING_AND_LOGGING_IMPLEMENTATION.md)
- [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](./ERROR_HANDLING_IMPLEMENTATION.md)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit Tests

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
cd auth-service
go test ./...

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö unit —Ç–µ—Å—Ç–æ–≤
go test ./...
```

### Integration Tests

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ end-to-end –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
cd integration-tests
./run_tests.sh

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è Make
make test

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –Ω–∞–±–æ—Ä–æ–≤
make test-employee    # –¢–µ—Å—Ç—ã Employee Service
make test-chat        # –¢–µ—Å—Ç—ã Chat Service
make test-structure   # –¢–µ—Å—Ç—ã Structure Service
make test-migration   # –¢–µ—Å—Ç—ã Migration Service
make test-grpc        # –¢–µ—Å—Ç—ã gRPC –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
```

**–ü–æ–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å —Ä–æ–ª—è–º–∏ –∏ MAX_id (Employee ‚Üí Auth ‚Üí MaxBot)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–∞—Ç–æ–≤ –ø–æ —Ä–æ–ª—è–º (Superadmin, Curator, Operator)
- ‚úÖ –ò–º–ø–æ—Ä—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑ Excel —Å –ø–æ–ª–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–µ–π
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, Google Sheets –∏ Excel
- ‚úÖ gRPC –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –º–µ–∂–¥—É –≤—Å–µ–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ —á–∞—Ç–æ–≤
- ‚úÖ –ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: [integration-tests/QUICK_START.md](./integration-tests/QUICK_START.md)
- –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: [integration-tests/INTEGRATION_TEST_GUIDE.md](./integration-tests/INTEGRATION_TEST_GUIDE.md)
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: [.kiro/specs/digital-university-mvp-completion/requirements.md](./.kiro/specs/digital-university-mvp-completion/requirements.md)

### Property-Based Testing

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç property-based testing (gopter) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤:

```bash
# –ó–∞–ø—É—Å–∫ property-based —Ç–µ—Å—Ç–æ–≤
cd employee-service
go test -v ./internal/usecase -run TestProperty

cd maxbot-service
go test -v ./internal/usecase -run TestPhoneNormalization
```

**–ü—Ä–∏–º–µ—Ä—ã —Å–≤–æ–π—Å—Ç–≤:**
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç E.164 —Ñ–æ—Ä–º–∞—Ç
- ABAC –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–±–ª—é–¥–∞–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—é —Ä–æ–ª–µ–π
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç 100
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –ú–∏–Ω–∏–º—É–º 100 –∏—Ç–µ—Ä–∞—Ü–∏–π –Ω–∞ —Å–≤–æ–π—Å—Ç–≤–æ
- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ shrinking –ø—Ä–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏ –∫–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä–∞

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫ (Troubleshooting)

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—É—Å–∫–æ–º

**–ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs auth-service

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker-compose exec auth-db psql -U postgres -d auth_db -c "SELECT 1;"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã
netstat -an | grep LISTEN | grep -E "8080|8081|8082|8083|8084"
```

**–ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
cd auth-service
make migrate-status

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-force VERSION=1

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É –º–∏–≥—Ä–∞—Ü–∏–π
psql -U postgres -d auth_db -c "SELECT * FROM schema_migrations;"
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å gRPC

**–ü—Ä–æ–±–ª–µ–º–∞: gRPC connection refused**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ gRPC —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
netstat -an | grep 9090

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ gRPC —Å–µ—Ä–≤–µ—Ä–∞
docker-compose logs auth-service | grep gRPC

# –¢–µ—Å—Ç gRPC —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
grpcurl -plaintext localhost:9090 list
```

**–ü—Ä–æ–±–ª–µ–º–∞: gRPC timeout**

–£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```go
// internal/infrastructure/grpc/client.go
conn, err := grpc.Dial(
    address,
    grpc.WithTimeout(10*time.Second),
    grpc.WithBlock(),
)
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å MAX API

**–ü—Ä–æ–±–ª–µ–º–∞: MAX_id –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω MAX API
curl -H "Authorization: Bearer $MAX_API_TOKEN" \
     https://api.max.ru/v1/users/search?phone=+79991234567

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ MaxBot Service
docker-compose logs maxbot-service | grep "MAX API"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —Ç–µ–ª–µ—Ñ–æ–Ω–∞
curl -X POST http://localhost:9095/normalize-phone \
     -d '{"phone": "89991234567"}'
```

**–ü—Ä–æ–±–ª–µ–º–∞: Batch –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–∏—Å–ª–∞**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å batch job
curl http://localhost:8081/employees/batch-status

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs employee-service | grep "batch"

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ batch –æ–ø–µ—Ä–∞—Ü–∏—é
curl -X POST http://localhost:8081/employees/batch-update-maxid
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–±–ª–µ–º–∞: Excel –∏–º–ø–æ—Ä—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞
file structure.xlsx

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–ª–∏–º–∏—Ç 50MB)
ls -lh structure.xlsx

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs migration-service | grep "excel"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
# –¢—Ä–µ–±—É—é—Ç—Å—è: phone, INN, org_name, chat_name, chat_url
```

**–ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–∏—Å–ª–∞**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
curl http://localhost:8084/migration/jobs/1

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏
curl http://localhost:8084/migration/jobs/1/errors

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
docker-compose restart migration-service
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

**–ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**

```bash
# –í–∫–ª—é—á–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ PostgreSQL
# postgresql.conf:
log_min_duration_statement = 1000  # –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã > 1s

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã
psql -U postgres -d chat_db -c "\d+ chats"

# –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞
psql -U postgres -d chat_db -c "EXPLAIN ANALYZE SELECT * FROM chats WHERE university_id = 1;"
```

**–ü—Ä–æ–±–ª–µ–º–∞: –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
docker stats

# –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø–∞–º—è—Ç—å –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose.yml:
  auth-service:
    mem_limit: 512m
    mem_reservation: 256m
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

**–ü—Ä–æ–±–ª–µ–º–∞: 403 Forbidden –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —Ä–µ—Å—É—Ä—Å–∞–º**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ JWT —Ç–æ–∫–µ–Ω
curl -X POST http://localhost:8080/auth/validate \
     -H "Authorization: Bearer $TOKEN"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl http://localhost:8080/users/123/permissions \
     -H "Authorization: Bearer $ADMIN_TOKEN"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Auth Service
docker-compose logs auth-service | grep "permission denied"
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã
docker-compose down -v
docker-compose up -d

# –û—á–∏—Å—Ç–∫–∞ Docker
docker system prune -a --volumes

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö health endpoints
for port in 8080 8081 8082 8083 8084; do
  echo "Checking port $port..."
  curl -s http://localhost:$port/health | jq .
done

# –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤
docker-compose logs > system_logs.txt

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
watch -n 1 'docker-compose ps'
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –¥–∏–∑–∞–π–Ω
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (Requirements)](./. kiro/specs/digital-university-mvp-completion/requirements.md)
- [–î–∏–∑–∞–π–Ω —Å–∏—Å—Ç–µ–º—ã (Design)](./. kiro/specs/digital-university-mvp-completion/design.md)
- [–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (Tasks)](./. kiro/specs/digital-university-mvp-completion/tasks.md)

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- [–†–æ–ª–µ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–∞—Ç–æ–≤](./chat-service/ROLE_BASED_FILTERING_IMPLEMENTATION.md)
- [–ü–∞–≥–∏–Ω–∞—Ü–∏—è](./chat-service/PAGINATION_IMPLEMENTATION.md)
- [–ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤](./chat-service/CHAT_SEARCH_IMPLEMENTATION.md)
- [–ü–∞–∫–µ—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ MAX_id](./employee-service/BATCH_UPDATE_IMPLEMENTATION.md)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MAX_id](./employee-service/MAX_ID_INTEGRATION_SUMMARY.md)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π](./structure-service/DEPARTMENT_MANAGERS_IMPLEMENTATION.md)
- [–ò–µ—Ä–∞—Ä—Ö–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã](./structure-service/STRUCTURE_HIERARCHY_IMPLEMENTATION.md)
- [–ò–º–ø–æ—Ä—Ç –∏–∑ Excel](./structure-service/EXCEL_IMPORT_IMPLEMENTATION.md)
- [–ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ MaxBot](./maxbot-service/BATCH_OPERATIONS_IMPLEMENTATION.md)

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ gRPC](./GRPC_SETUP.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è retry –ª–æ–≥–∏–∫–∏](./GRPC_RETRY_IMPLEMENTATION.md)
- [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](./ERROR_HANDLING_IMPLEMENTATION.md)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](./MONITORING_AND_LOGGING_IMPLEMENTATION.md)
- [–ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö](./MIGRATIONS.md)

### –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- [–ë—ã—Å—Ç—Ä–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏](./QUICK_MIGRATION_GUIDE.md)
- [–°–≤–æ–¥–∫–∞ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏](./MIGRATION_SUMMARY.md)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Migration Service](./migration-service/MIGRATION_SERVICE_IMPLEMENTATION.md)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MAX Messenger
- [MaxBot Service README](./maxbot-service/README.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ MaxBot](./maxbot-service/INTEGRATION_GUIDE.md)
- [–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (Employee)](./employee-service/MAXBOT_INTEGRATION_EXAMPLES.md)
- [–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (Chat)](./chat-service/MAXBOT_INTEGRATION_EXAMPLES.md)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç MaxBot](./QUICK_START_MAXBOT_INTEGRATION.md)
- [–°–≤–æ–¥–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ MaxBot](./MAXBOT_INTEGRATION_SUMMARY.md)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤](./integration-tests/QUICK_START.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç–µ—Å—Ç–∞–º](./integration-tests/INTEGRATION_TEST_GUIDE.md)
- [–°–≤–æ–¥–∫–∞ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç–µ—Å—Ç–∞–º](./integration-tests/IMPLEMENTATION_SUMMARY.md)
- [–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã](./INTEGRATION_TESTS_COMPLETED.md)

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:
- –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `.kiro/specs/`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ implementation guides

## –õ–∏—Ü–µ–Ω–∑–∏—è

[–£–∫–∞–∂–∏—Ç–µ –ª–∏—Ü–µ–Ω–∑–∏—é –ø—Ä–æ–µ–∫—Ç–∞]
