# Реализация пагинации, сортировки и поиска для /universities

## Что было добавлено

### 1. Новые методы в репозитории
- `GetAllUniversitiesWithSortingAndSearch()` - получение университетов с сортировкой и поиском

### 2. Новый метод в сервисе
- `GetAllUniversitiesWithSortingAndSearch()` - бизнес-логика для работы с расширенными параметрами

### 3. Обновленный HTTP хендлер
- Поддержка новых query параметров: `sort_by`, `sort_order`, `search`
- Возврат структурированного ответа с метаданными пагинации

### 4. Новые структуры
- `PaginatedUniversitiesResponse` - структура ответа с пагинацией
- `StructureServiceInterface` - интерфейс для сервиса структуры

## Поддерживаемые параметры

### Пагинация
- `limit` - количество записей (по умолчанию 50, максимум 100)
- `offset` - смещение от начала

### Сортировка
- `sort_by` - поле для сортировки (id, name, inn, kpp, foiv, created_at, updated_at)
- `sort_order` - порядок сортировки (asc, desc)

### Поиск
- `search` - поисковый запрос по всем полям университета

## Поля для поиска
- Название университета
- ИНН
- КПП
- ФОИВ (федеральный орган исполнительной власти)

## Формат ответа
```json
{
  "data": [...],
  "total": 150,
  "limit": 50,
  "offset": 0,
  "total_pages": 3
}
```

## Файлы изменены
1. `internal/domain/structure_repository.go` - добавлен новый метод в интерфейс
2. `internal/infrastructure/repository/structure_postgres.go` - реализация нового метода
3. `internal/usecase/structure_service.go` - новый метод сервиса
4. `internal/infrastructure/http/handler.go` - обновленный хендлер
5. `internal/domain/structure_service.go` - новый интерфейс сервиса

## Файлы созданы
1. `internal/infrastructure/http/handler_pagination_test.go` - тесты для новой функциональности
2. `PAGINATION_SORTING_SEARCH_API.md` - документация API
3. `USAGE_EXAMPLES.md` - примеры использования

## Тесты
Созданы тесты для проверки:
- Пагинации
- Поиска
- Сортировки

## Обратная совместимость
Все изменения обратно совместимы. Старые запросы без новых параметров продолжают работать как раньше.

## Производительность
- Поиск использует LIKE с оптимизацией для PostgreSQL
- Сортировка оптимизирована для индексированных полей
- Пагинация предотвращает загрузку больших объемов данных

## Особенности реализации
- Поддержка поиска по всем основным полям университета
- Валидация параметров сортировки
- Безопасное построение SQL-запросов с параметрами
- Подсчет общего количества записей для корректной пагинации

## Интеграция с другими сервисами
API может использоваться для:
- Получения списка университетов в других сервисах
- Поиска университетов по ИНН при создании сотрудников
- Аналитики и отчетности
- Автокомплита в пользовательских интерфейсах

## Примеры использования
- Поиск университетов по названию для выпадающих списков
- Фильтрация по ФОИВ для административных отчетов
- Сортировка по дате создания для анализа роста базы данных
- Поиск по ИНН для интеграции с внешними системами